# Linux下VIM编码设置——解决中文乱码问题

> 远程Vim的工作原理可以简单地理解为从文件读取数据，将数据从__文件的存储编码__转换到终端可识别的__终端编码__，终端将数据流转发给SSH客户端，SSH客户端则根据客户端内配置的__SSH客户端编码__来对数据流解码，并将内容呈现给用户。这三个编码我们最关心的是文件的存储编码，然而在配置的时候必须保证三个编码都配置正确，才能正确地显示和转换中文。

## 正确的配置（UTF-8）

首先，__终端编码与SSH客户端编码需保持一致__，客户端编码的查看与配置方法各有差异，在此不作分析；终端编码可通过如下命令查看：

```
locale charmap
```

如果不是UTF-8的话（默认为ISO-8859-1），可以通过修改环境变量 `LANG` 和 `LC_ALL` 来修改，将如下两行添加进 `.bashrc`

```
export LANG='en_US.UTF-8'
export LC_ALL='en_US.UTF-8'
```

这时再通过 `locale` 命令查看终端编码应该已经变成UTF-8了。

接下来要配置Vim，在正确地配置了终端编码为UTF-8之后，将下面一行添加进 `.vimrc` 即可：

```
set fencs=utf-8
```

注意：无需配置`fenc`、`enc`、`tenc`这三个变量！

至此，Vim显示中文的问题应该可以完美解决了！

## Vim配置解析

Vim与编码相关的配置选项有四个，分别是`fileencodings(fencs)`，`fileencoding(fenc)`， `encoding(enc)`和`termencoding(tenc)`，其中 `fencs`为一个编码列表，当打开一个文件时，Vim会依次尝试利用列表中的编码去解读文件内容； `fenc`告诉Vim以哪种编码保存文件内容； `enc`告诉Vim将文件内容转为哪种编码存储在Vim工作缓冲区内； `tenc`告诉Vim将缓冲区内的编码转换为何种编码发送给终端。
